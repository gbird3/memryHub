{% extends "base.html" %}

{% load static %}

{% block title %}MemryHub{% endblock %}

{% block css %}
  <link rel="stylesheet" type="text/css" href={% static "timeline/css/view.css" %}>
  <link rel="stylesheet" type="text/css" href={% static "home/css/font-awesome/css/font-awesome.min.css" %}>
{% endblock %}

{% block content %}
  <div class = "container-fluid">
    <div class = "row">
      <div class = "col-lg-12">
        <div class = "main-title">
          <h1>{{ timeline.name}}</h1>
          <p> {{ timeline.description }}</p>
          <a href="{% url 'add_memory' timeline.id %}" class="btn btn-info bottom-buffer" id = "add-memory-button">Add Memory</a>
        </div>
      </div>
    </div>

    <!--First Timeline Divider-->
    <div class = "row">
      <div class = "col-lg 12">
        <div class="timeline-divider text-center">
          <hr/>
          <h2>{{first_year}}</h2>
          <hr/>
        </div>
      </div>
    </div>

    <!--Cards-->
    {% for memory in memories_with_years %}
      <!--Dividers-->
      {% if memory.divider_year > 0 %}
        <div class = "row">
          <div class = "col-lg 12">
            <div class="timeline-divider text-center">
              <hr/>
              <h2>{{memory.divider_year}}</h2>
              <hr/>
            </div>
          </div>
        </div>
      {% endif %}

      {% if memory.year > 0 %}
      <div class = "row">
        <div class = "col-lg 12">
          <div class="card text-center center-block" style = "width: 80%">
    				<div class="card-block header-block">
              <h3 class="card-title">{{ memory.name }}</h3>
              <h4 class ="card-subtitle">
                {% if memory.month is None %}
                {% else %}
                  {{ memory.month }}/
                {% endif %}
                {% if memory.day is None %}
                {% else %}
                  {{ memory.day }}/
                {% endif %}
                {% if memory.year is None %}
                {% else %}
                  {{ memory.year }}
                {% endif %}
              </h4>
              <p class="card-description">{{ memory.description }}</p>
              <div class = "location">
                <h5>
                {% if memory.city is None or memory.city == "" %}
                {% else %}
                  {{ memory.city }},
                {% endif %}

                {% if memory.state is None or memory.state == "" %}
                {% else %}
                  {{ memory.state }},
                {% endif %}

                {% if memory.country is None or memory.country == "" %}
                {% else %}
                  {{ memory.country }}
                {% endif %}
              </h5>
              </div>
              <a href="#" class="btn btn-secondary btn-sm add-file-button">Attach File</a>
              <br>
              <a href="" class = "collapse-link" data-toggle = "collapse" data-target = ".preview-memory-collapse-{{ memory.id }}" aria-expanded="false" aria-controls="collapseExample">Preview All</a>
            </div>


            <div class = "card-columns">
            {% for file in files %}
              {% if file.memory == memory %}
              <div class = "card file-card">
                <!--<h5  data-toggle ="tooltip" title = "Location: {{memory.city}}, {{memory.state}}" data-placement="bottom">{{file.name}}</h5>-->
                <h4>{{file.name}}</h4>
                <!--<h5  data-toggle ="tooltip"  title = "Location: {{memory.city}}, {{memory.state}}" data-placement="top">{{file.name}}</h5>-->
                <a href="https://drive.google.com/file/d/{{ file.file_id }}/preview?usp=sharing" target="_blank">
                  {% if file.file_type == 'audio' %}
                  <i class="fa fa-file-audio-o "></i>
                  {% elif file.file_type == 'video' %}
                  <i class="fa fa-file-video-o "></i>
                  {% elif file.file_type == 'application' %}
                  <i class="fa fa-file-text-o "></i>
                  {% elif file.file_type == 'image' %}
                  <i class="fa fa-file-image-o "></i>
                  {% else %}
                  <i class="fa fa-file-o "></i>
                  {% endif %}
                </a>
                <br>
                <a href="" class = "collapse-link" data-toggle = "collapse" data-target = "#preview-file-collapse-{{ file.file_id }}" aria-expanded="false" aria-controls="collapseExample">Preview</a>
                <div class="collapse preview-memory-collapse-{{ memory.id }}" id ="preview-file-collapse-{{ file.file_id }}" >
                  <iframe frameborder="0" src="https://drive.google.com/file/d/{{ file.file_id }}/preview?usp=sharing" data-toggle ="tooltip" title = "Location: {{memory.city}}, {{memory.state}}" data-placement="bottom"></iframe>
                </div>
              </div>
              {% endif %}

              <!--
              {% if file.file_type == 'audio' and file.memory == memory %}
              <div class = "card-block audio-block">
                <h5  data-toggle ="tooltip" title = "Location: {{memory.city}}, {{memory.state}}" data-placement="bottom">{{memory.description}}</h5>
                <iframe frameborder="0" src="https://drive.google.com/file/d/{{ file.file_id }}/preview?usp=sharing" data-toggle ="tooltip" title = "Location: {{memory.city}}, {{memory.state}}" data-placement="bottom"></iframe>
              </div>
              {% endif %}

              {% if file.file_type == 'video' and file.memory == memory %}
              <div class = "card-block video-block">
                <h5 data-toggle ="tooltip" title = "Location: {{memory.city}}, {{memory.state}}" data-placement="bottom">{{memory.description}}</h5>
                <iframe frameborder="0" src="https://drive.google.com/file/d/{{ file.file_id }}/preview?usp=sharing" data-toggle ="tooltip" title = "Location: {{memory.city}}, {{memory.state}}" data-placement="bottom"></iframe>
              </div>
              {% endif %}

              {% if file.file_type == 'application' and file.memory == memory  %}
              <div class = "card-block text-block">
                <h5 data-toggle ="tooltip" title = "Location: {{memory.city}}, {{memory.state}}" data-placement="bottom">{{memory.description}}</h5>
                <iframe frameborder="0" src="https://drive.google.com/file/d/{{ file.file_id }}/preview?usp=sharing" data-toggle ="tooltip" title = "Location: {{memory.city}}, {{memory.state}}" data-placement="bottom"></iframe>
              </div>
              {% endif %}

              {% if file.file_type == 'image' and file.memory == memory %}
              <div class = "card-block picture-block">
                <h5 data-toggle ="tooltip" title = "Location: {{memory.city}}, {{memory.state}}" data-placement="bottom">{{memory.description}}</h5>
                <iframe frameborder="0" src="https://drive.google.com/file/d/{{ file.file_id }}/preview?usp=sharing" data-toggle ="tooltip" title = "Location: {{memory.city}}, {{memory.state}}" data-placement="bottom"></iframe>
              </div>
              {% endif %}
            -->
            {% endfor %}
          </div>

            <div class = "card-block footer-block">
              <h6>Memory Owner: {{ memory.owner.first_name }}</h6>
              <a href="{% url 'edit_memory' memory.id %}">Edit Memory Details</a>
              <br>
              <a href="{% url 'delete_memory' memory.id %}" style = "color:red">Delete Memory</a>
            </div>
  				</div>
        </div>
      </div>
      {% endif %}
    {% endfor %}
  </div>

  <!--Last Timeline Divider-->
  <div class = "row">
    <div class = "col-lg 12">
      <div class="timeline-divider text-center">
        <hr/>
        <h2>{{last_year}}</h2>
        <hr/>
      </div>
    </div>
  </div>

{% endblock %}

{% block js %}
  <script src = {% static "timeline/js/view.js" %}></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/tether/1.4.3/js/tether.min.js"></script>
{% endblock %}
